/*!
 * Copyright (c) 2021 Momo Bassit.
 * Licensed under the MIT License (MIT)
 * https://github.com/mdbassit/Coloris
 */
((u,d,i,p)=>{const a=d.createElement("canvas").getContext("2d"),s={r:0,g:0,b:0,h:0,s:0,v:0,a:1};let h,f,b,y,v,g,m,w,k,r,L,E,x,A,l,c,S={};const T={el:"[data-coloris]",parent:"body",theme:"default",themeMode:"light",rtl:!1,wrap:!0,margin:2,format:"hex",formatToggle:!1,swatches:[],swatchesOnly:!1,alpha:!0,forceAlpha:!1,focusInput:!0,selectInput:!1,inline:!1,defaultColor:"#000000",clearButton:!1,clearLabel:"Clear",closeButton:!1,closeLabel:"Close",onChange:()=>p,a11y:{open:"Open color picker",close:"Close color picker",clear:"Clear the selected color",marker:"Saturation: {s}. Brightness: {v}.",hueSlider:"Hue slider",alphaSlider:"Opacity slider",input:"Color value field",format:"Color format",swatch:"Color swatch",instruction:"Saturation and brightness selector. Use up, down, left and right arrow keys to select."},wrapNoDiv:!0},o={};let n="",C={},B=!1;function M(t){if("object"==typeof t)for(const r in t)switch(r){case"el":O(t.el),!1!==t.wrap&&j(t.el);break;case"parent":h=d.querySelector(t.parent),h&&(h.appendChild(f),T.parent=t.parent,h===d.body&&(h=p));break;case"themeMode":T.themeMode=t.themeMode,"auto"===t.themeMode&&u.matchMedia&&u.matchMedia("(prefers-color-scheme: dark)").matches&&(T.themeMode="dark");case"theme":t.theme&&(T.theme=t.theme),f.className="clr-picker clr-"+T.theme+" clr-"+T.themeMode,T.inline&&I();break;case"rtl":T.rtl=!!t.rtl,d.querySelectorAll(".clr-field").forEach(e=>e.classList.toggle("clr-rtl",T.rtl));break;case"margin":t.margin*=1,T.margin=(isNaN(t.margin)?T:t).margin;break;case"wrap":t.el&&t.wrap&&(t.wrapNoDiv&&(T.wrapNoDiv=t.wrapNoDiv),j(t.el));break;case"formatToggle":T.formatToggle=!!t.formatToggle,$("clr-format").style.display=T.formatToggle?"block":"none",T.formatToggle&&(T.format="auto");break;case"swatches":if(Array.isArray(t.swatches)){const o=[];t.swatches.forEach((e,t)=>{o.push('<button type="button" id="clr-swatch-'+t+'" aria-labelledby="clr-swatch-label clr-swatch-'+t+'" style="color: '+e+';">'+e+"</button>")}),$("clr-swatches").innerHTML=o.length?"<div>"+o.join("")+"</div>":"",T.swatches=t.swatches.slice()}break;case"swatchesOnly":T.swatchesOnly=!!t.swatchesOnly,f.setAttribute("data-minimal",T.swatchesOnly);break;case"alpha":T.alpha=!!t.alpha,f.setAttribute("data-alpha",T.alpha);break;case"inline":var l;T.inline=!!t.inline,f.setAttribute("data-inline",T.inline),T.inline&&(l=t.defaultColor||T.defaultColor,A=q(l),I(),W(l));break;case"clearButton":"object"==typeof t.clearButton&&(t.clearButton.label&&(T.clearLabel=t.clearButton.label,m.innerHTML=T.clearLabel),t.clearButton=t.clearButton.show),T.clearButton=!!t.clearButton,m.style.display=T.clearButton?"block":"none";break;case"clearLabel":T.clearLabel=t.clearLabel,m.innerHTML=T.clearLabel;break;case"closeButton":T.closeButton=!!t.closeButton,T.closeButton?f.insertBefore(w,v):v.appendChild(w);break;case"closeLabel":T.closeLabel=t.closeLabel,w.innerHTML=T.closeLabel;break;case"a11y":var a=t.a11y;let e=!1;if("object"==typeof a)for(const n in a)a[n]&&T.a11y[n]&&(T.a11y[n]=a[n],e=!0);if(e){const c=$("clr-open-label"),s=$("clr-swatch-label");c.innerHTML=T.a11y.open,s.innerHTML=T.a11y.swatch,w.setAttribute("aria-label",T.a11y.close),m.setAttribute("aria-label",T.a11y.clear),k.setAttribute("aria-label",T.a11y.hueSlider),L.setAttribute("aria-label",T.a11y.alphaSlider),g.setAttribute("aria-label",T.a11y.input),b.setAttribute("aria-label",T.a11y.instruction)}break;default:T[r]=t[r]}}function H(e,t){"string"==typeof e&&"object"==typeof t&&(o[e]=t,B=!0)}function D(e){delete o[e],0===Object.keys(o).length&&(B=!1,e===n&&N())}function N(){0<Object.keys(C).length&&(M(C),n="",C={})}function O(e){z(d,"click",e,e=>{T.inline||(function(e){if(B){const a=["el","wrap","rtl","inline","defaultColor","a11y"];for(var t in o){const r=o[t];if(e.matches(t)){for(var l in n=t,C={},a.forEach(e=>delete r[e]),r)C[l]=Array.isArray(T[l])?T[l].slice():T[l];M(r);break}}}}(e.target),x=e.target,l=x.value,A=q(l),f.classList.add("clr-open"),I(),W(l),(T.focusInput||T.selectInput)&&(g.focus({preventScroll:!0}),g.setSelectionRange(x.selectionStart,x.selectionEnd)),T.selectInput&&g.select(),(c||T.swatchesOnly)&&K().shift().focus(),x.dispatchEvent(new Event("open",{bubbles:!0})))}),z(d,"input",e,e=>{const t=e.target.parentNode;t.classList.contains("clr-field")&&(t.style.color=e.target.value)})}function I(){const l=h;var a=u.scrollY,r=f.offsetWidth,o=f.offsetHeight;const n={left:!1,top:!1};let e,c,t,s={x:0,y:0};if(l&&(e=u.getComputedStyle(l),c=parseFloat(e.marginTop),t=parseFloat(e.borderTopWidth),s=l.getBoundingClientRect(),s.y+=t+a),!T.inline){var i=x.getBoundingClientRect();let e=i.x,t=a+i.y+i.height+T.margin;l?(e-=s.x,t-=s.y,e+r>l.clientWidth&&(e+=i.width-r,n.left=!0),t+o>l.clientHeight-c&&o+T.margin<=i.top-(s.y-a)&&(t-=i.height+o+2*T.margin,n.top=!0),t+=l.scrollTop):(e+r>d.documentElement.clientWidth&&(e+=i.width-r,n.left=!0),t+o-a>d.documentElement.clientHeight&&o+T.margin<=i.top&&(t=a+i.y-o-T.margin,n.top=!0)),f.classList.toggle("clr-left",n.left),f.classList.toggle("clr-top",n.top),f.style.left=e+"px",f.style.top=t+"px",s.x+=f.offsetLeft,s.y+=f.offsetTop}S={width:b.offsetWidth,height:b.offsetHeight,x:b.offsetLeft+s.x,y:b.offsetTop+s.y}}function j(e){d.querySelectorAll(e).forEach(t=>{const l=t.parentNode;if(!l.classList.contains("clr-field"))if(T.wrapNoDiv){const e=t;e.insertAdjacentHTML("afterend",'<button type="button" class="coloris-button" aria-labelledby="clr-open-label"></button>'),l.classList.add("clr-field"),l.style.color=t.value}else{const a=d.createElement("div");let e="clr-field";(T.rtl||t.classList.contains("clr-rtl"))&&(e+=" clr-rtl"),a.innerHTML='<button type="button" aria-labelledby="clr-open-label"></button>',l.insertBefore(a,t),a.setAttribute("class",e),a.style.color=t.value,a.appendChild(t)}})}function R(e){if(x&&!T.inline){const t=x;e&&(x=p,l!==t.value&&(t.value=l,t.dispatchEvent(new Event("input",{bubbles:!0})))),setTimeout(()=>{l!==t.value&&t.dispatchEvent(new Event("change",{bubbles:!0}))}),f.classList.remove("clr-open"),B&&N(),t.dispatchEvent(new Event("close",{bubbles:!0})),T.focusInput&&t.focus({preventScroll:!0}),x=p}}function W(e){var t=function(e){let t,l;a.fillStyle="#000",a.fillStyle=e,t=/^((rgba)|rgb)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i.exec(a.fillStyle),t?(l={r:+t[3],g:+t[4],b:+t[5],a:+t[6]},l.a=+l.a.toFixed(2)):(t=a.fillStyle.replace("#","").match(/.{2}/g).map(e=>parseInt(e,16)),l={r:t[0],g:t[1],b:t[2],a:1});return l}(e),e=function(e){var t=e.r/255,l=e.g/255,a=e.b/255,r=i.max(t,l,a),o=i.min(t,l,a),n=r-o,o=r;let c=0,s=0;n&&(r===t&&(c=(l-a)/n),r===l&&(c=2+(a-t)/n),r===a&&(c=4+(t-l)/n),r&&(s=n/r));return c=i.floor(60*c),{h:c<0?c+360:c,s:i.round(100*s),v:i.round(100*o),a:e.a}}(t);P(e.s,e.v),X(t,e),k.value=e.h,f.style.color="hsl("+e.h+", 100%, 50%)",r.style.left=e.h/360*100+"%",y.style.left=S.width*e.s/100+"px",y.style.top=S.height-S.height*e.v/100+"px",L.value=100*e.a,E.style.left=100*e.a+"%"}function q(e){e=e.substring(0,3).toLowerCase();return"rgb"===e||"hsl"===e?e:"hex"}function F(e){e=e!==p?e:g.value,x&&(x.value=e,x.dispatchEvent(new Event("input",{bubbles:!0}))),T.onChange&&T.onChange.call(u,e,x),d.dispatchEvent(new CustomEvent("coloris:pick",{detail:{color:e,currentEl:x}}))}function Y(e,t){e={h:+k.value,s:e/S.width*100,v:100-t/S.height*100,a:L.value/100},t=function(e){var t=e.s/100,l=e.v/100;var a=t*l,r=e.h/60,o=a*(1-i.abs(r%2-1)),n=l-a;a+=n,o+=n;t=i.floor(r)%6,l=[a,o,n,n,o,a][t],r=[o,a,a,o,n,n][t],t=[n,n,o,a,a,o][t];return{r:i.round(255*l),g:i.round(255*r),b:i.round(255*t),a:e.a}}(e);P(e.s,e.v),X(t,e),F()}function P(e,t){let l=T.a11y.marker;e=+e.toFixed(1),t=+t.toFixed(1),l=l.replace("{s}",e),l=l.replace("{v}",t),y.setAttribute("aria-label",l)}function t(e){var t={pageX:((l=e).changedTouches?l.changedTouches[0]:l).pageX,pageY:(l.changedTouches?l.changedTouches[0]:l).pageY},l=t.pageX-S.x;let a=t.pageY-S.y;h&&(a+=h.scrollTop),U(l,a),e.preventDefault(),e.stopPropagation()}function U(e,t){e=e<0?0:e>S.width?S.width:e,t=t<0?0:t>S.height?S.height:t,y.style.left=e+"px",y.style.top=t+"px",Y(e,t),y.focus()}function X(e={},t={}){let l=T.format;for(const n in e)s[n]=e[n];for(const c in t)s[c]=t[c];const a=function(e){let t=e.r.toString(16),l=e.g.toString(16),a=e.b.toString(16),r="";e.r<16&&(t="0"+t);e.g<16&&(l="0"+l);e.b<16&&(a="0"+a);if(T.alpha&&(e.a<1||T.forceAlpha)){const o=255*e.a|0;r=o.toString(16),o<16&&(r="0"+r)}return"#"+t+l+a+r}(s);var r,o=a.substring(0,7);switch(y.style.color=o,E.parentNode.style.color=o,E.style.color=a,v.style.color=a,b.style.display="none",b.offsetHeight,b.style.display="",E.nextElementSibling.style.display="none",E.nextElementSibling.offsetHeight,E.nextElementSibling.style.display="","mixed"===l?l=1===s.a?"hex":"rgb":"auto"===l&&(l=A),l){case"hex":g.value=a;break;case"rgb":g.value=(r=s,!T.alpha||1===r.a&&!T.forceAlpha?"rgb("+r.r+", "+r.g+", "+r.b+")":"rgba("+r.r+", "+r.g+", "+r.b+", "+r.a+")");break;case"hsl":g.value=(r=function(e){var t=e.v/100,l=t*(1-e.s/100/2);let a;0<l&&l<1&&(a=i.round((t-l)/i.min(l,1-l)*100));return{h:e.h,s:a||0,l:i.round(100*l),a:e.a}}(s),!T.alpha||1===r.a&&!T.forceAlpha?"hsl("+r.h+", "+r.s+"%, "+r.l+"%)":"hsla("+r.h+", "+r.s+"%, "+r.l+"%, "+r.a+")")}d.querySelector('.clr-format [value="'+l+'"]').checked=!0}function e(){var e=+k.value,t=+y.style.left.replace("px",""),l=+y.style.top.replace("px","");f.style.color="hsl("+e+", 100%, 50%)",r.style.left=e/360*100+"%",Y(t,l)}function G(){var e=L.value/100;E.style.left=100*e+"%",X({a:e}),F()}function K(){const e=Array.from(f.querySelectorAll("input, button"));return e.filter(e=>!!e.offsetWidth)}function $(e){return d.getElementById(e)}function z(e,t,l,a){const r=Element.prototype.matches||Element.prototype.msMatchesSelector;"string"==typeof l?e.addEventListener(t,e=>{r.call(e.target,l)&&a.call(e.target,e)}):(a=l,e.addEventListener(t,a))}function J(e,t){t=t!==p?t:[],"loading"!==d.readyState?e(...t):d.addEventListener("DOMContentLoaded",()=>{e(...t)})}NodeList!==p&&NodeList.prototype&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),u.Coloris=(()=>{const t={set:M,wrap:j,close:R,setInstance:H,removeInstance:D,updatePosition:I,ready:J};function e(e){J(()=>{e&&("string"==typeof e?O:M)(e)})}for(const l in t)e[l]=(...e)=>{J(t[l],e)};return e})(),J(function(){h=p,f=d.createElement("div"),f.setAttribute("id","clr-picker"),f.className="clr-picker",f.innerHTML='<input id="clr-color-value" name="clr-color-value" class="clr-color" type="text" value="" spellcheck="false" aria-label="'+T.a11y.input+'"><div id="clr-color-area" class="clr-gradient" role="application" aria-label="'+T.a11y.instruction+'"><div id="clr-color-marker" class="clr-marker" tabindex="0"></div></div><div class="clr-hue"><input id="clr-hue-slider" name="clr-hue-slider" type="range" min="0" max="360" step="1" aria-label="'+T.a11y.hueSlider+'"><div id="clr-hue-marker"></div></div><div class="clr-alpha"><input id="clr-alpha-slider" name="clr-alpha-slider" type="range" min="0" max="100" step="1" aria-label="'+T.a11y.alphaSlider+'"><div id="clr-alpha-marker"></div><span></span></div><div id="clr-format" class="clr-format"><fieldset class="clr-segmented"><legend>'+T.a11y.format+'</legend><input id="clr-f1" type="radio" name="clr-format" value="hex"><label for="clr-f1">Hex</label><input id="clr-f2" type="radio" name="clr-format" value="rgb"><label for="clr-f2">RGB</label><input id="clr-f3" type="radio" name="clr-format" value="hsl"><label for="clr-f3">HSL</label><span></span></fieldset></div><div id="clr-swatches" class="clr-swatches"></div><button type="button" id="clr-clear" class="clr-clear" aria-label="'+T.a11y.clear+'">'+T.clearLabel+'</button><div id="clr-color-preview" class="clr-preview"><button type="button" id="clr-close" class="clr-close" aria-label="'+T.a11y.close+'">'+T.closeLabel+'</button></div><span id="clr-open-label" hidden>'+T.a11y.open+'</span><span id="clr-swatch-label" hidden>'+T.a11y.swatch+"</span>",d.body.appendChild(f),b=$("clr-color-area"),y=$("clr-color-marker"),m=$("clr-clear"),w=$("clr-close"),v=$("clr-color-preview"),g=$("clr-color-value"),k=$("clr-hue-slider"),r=$("clr-hue-marker"),L=$("clr-alpha-slider"),E=$("clr-alpha-marker"),O(T.el),j(T.el),z(f,"mousedown",e=>{f.classList.remove("clr-keyboard-nav"),e.stopPropagation()}),z(b,"mousedown",e=>{z(d,"mousemove",t)}),z(b,"touchstart",e=>{d.addEventListener("touchmove",t,{passive:!1})}),z(y,"mousedown",e=>{z(d,"mousemove",t)}),z(y,"touchstart",e=>{d.addEventListener("touchmove",t,{passive:!1})}),z(g,"change",e=>{var t=g.value;(x||T.inline)&&F(""===t?t:W(t))}),z(m,"click",e=>{F(""),R()}),z(w,"click",e=>{F(),R()}),z($("clr-format"),"click",".clr-format input",e=>{A=e.target.value,X(),F()}),z(f,"click",".clr-swatches button",e=>{W(e.target.textContent),F(),T.swatchesOnly&&R()}),z(d,"mouseup",e=>{d.removeEventListener("mousemove",t)}),z(d,"touchend",e=>{d.removeEventListener("touchmove",t)}),z(d,"mousedown",e=>{c=!1,f.classList.remove("clr-keyboard-nav"),R()}),z(d,"keydown",e=>{var t=e.key;const l=e.target;var a=e.shiftKey;if("Escape"===t?R(!0):["Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t)&&(c=!0,f.classList.add("clr-keyboard-nav")),"Tab"===t&&l.matches(".clr-picker *")){const r=K(),o=r.shift(),n=r.pop();a&&l===o?(n.focus(),e.preventDefault()):a||l!==n||(o.focus(),e.preventDefault())}}),z(d,"click",".clr-field button",e=>{B&&N(),e.target.nextElementSibling.dispatchEvent(new Event("click",{bubbles:!0}))}),z(y,"keydown",e=>{var t={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]};Object.keys(t).includes(e.key)&&(function(e,t){U(+y.style.left.replace("px","")+e,+y.style.top.replace("px","")+t)}(...t[e.key]),e.preventDefault())}),z(b,"click",t),z(k,"input",e),z(L,"input",G)})})(window,document,Math);